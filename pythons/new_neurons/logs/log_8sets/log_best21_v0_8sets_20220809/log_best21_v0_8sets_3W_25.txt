2022-08-08 01:30:32.923410: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
tf:  2.8.0
/home/chau/workingdir/tf_implementations/bash_scripts
{'batchSize': 4.0, 'numTrainingSteps': 320000.0, 'beta1': 0.974833, 'beta2': 0.99689, 'epsilon': 0.00388, 'decayDurationFactor': 0.979079, 'initialLearningRate': 0.002798, 'learningRateDecay': 0.001025, 'glorotScaleFactor': 0.1, 'orthogonalScaleFactor': 0.1, 'testSize': 0.5, 'noUnits': 81, 'timestep': 40}
Path: ../../Datasets/8_publicDatasets/datasets/3W/train25.csv - Shape: (1431, 1600) - Timestep: 64 - NoIn: 8 - NoOut: 17
{'batchSize': 4, 'numTrainingSteps': 320000, 'beta1': 0.992102, 'beta2': 0.999223, 'epsilon': 0.000182, 'decayDurationFactor': 0.905429, 'initialLearningRate': 0.000677, 'learningRateDecay': 0.002604, 'glorotScaleFactor': 0.1, 'orthogonalScaleFactor': 0.1, 'noUnits': 128, 'timestep': 64}
float64
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 RNNp_layer (RNN)            (None, 128)               68352     
                                                                 
 MLP_layer (Dense)           (None, 25)                3225      
                                                                 
 Output_layer (Dense)        (None, 17)                442       
                                                                 
=================================================================
Total params: 72,019
Trainable params: 72,019
Non-trainable params: 0
_________________________________________________________________
None
  1/358 [..............................] - ETA: 11s - loss: 0.2301 - categorical_accuracy: 0.2500 - binary_accuracy: 0.8676 - accuracy: 0.0000e+00  4/358 [..............................] - ETA: 5s - loss: 0.2986 - categorical_accuracy: 0.5625 - binary_accuracy: 0.8934 - accuracy: 0.0000e+00   8/358 [..............................] - ETA: 5s - loss: 0.3851 - categorical_accuracy: 0.3750 - binary_accuracy: 0.8566 - accuracy: 0.0000e+00 12/358 [>.............................] - ETA: 5s - loss: 0.3848 - categorical_accuracy: 0.4167 - binary_accuracy: 0.8542 - accuracy: 0.0000e+00 16/358 [>.............................] - ETA: 5s - loss: 0.3525 - categorical_accuracy: 0.4531 - binary_accuracy: 0.8676 - accuracy: 0.0000e+00 20/358 [>.............................] - ETA: 5s - loss: 0.3205 - categorical_accuracy: 0.3875 - binary_accuracy: 0.8676 - accuracy: 0.0000e+00 24/358 [=>............................] - ETA: 5s - loss: 0.3140 - categorical_accuracy: 0.4062 - binary_accuracy: 0.8707 - accuracy: 0.0000e+00 28/358 [=>............................] - ETA: 5s - loss: 0.2881 - categorical_accuracy: 0.4018 - binary_accuracy: 0.8761 - accuracy: 0.0000e+00 32/358 [=>............................] - ETA: 5s - loss: 0.2905 - categorical_accuracy: 0.3750 - binary_accuracy: 0.8718 - accuracy: 0.0000e+00 36/358 [==>...........................] - ETA: 5s - loss: 0.2890 - categorical_accuracy: 0.3403 - binary_accuracy: 0.8668 - accuracy: 0.0000e+00 40/358 [==>...........................] - ETA: 5s - loss: 0.2774 - categorical_accuracy: 0.3438 - binary_accuracy: 0.8702 - accuracy: 0.0000e+00 44/358 [==>...........................] - ETA: 5s - loss: 0.2864 - categorical_accuracy: 0.3750 - binary_accuracy: 0.8700 - accuracy: 0.0000e+00 48/358 [===>..........................] - ETA: 5s - loss: 0.2849 - categorical_accuracy: 0.3750 - binary_accuracy: 0.8710 - accuracy: 0.0000e+00 52/358 [===>..........................] - ETA: 4s - loss: 0.2870 - categorical_accuracy: 0.3798 - binary_accuracy: 0.8708 - accuracy: 0.0000e+00 56/358 [===>..........................] - ETA: 4s - loss: 0.2908 - categorical_accuracy: 0.3750 - binary_accuracy: 0.8695 - accuracy: 0.0000e+00 60/358 [====>.........................] - ETA: 4s - loss: 0.2915 - categorical_accuracy: 0.3750 - binary_accuracy: 0.8691 - accuracy: 0.0000e+00 64/358 [====>.........................] - ETA: 4s - loss: 0.2944 - categorical_accuracy: 0.3633 - binary_accuracy: 0.8679 - accuracy: 0.0000e+00 68/358 [====>.........................] - ETA: 4s - loss: 0.2936 - categorical_accuracy: 0.3676 - binary_accuracy: 0.8694 - accuracy: 0.0000e+00 72/358 [=====>........................] - ETA: 4s - loss: 0.2976 - categorical_accuracy: 0.3715 - binary_accuracy: 0.8691 - accuracy: 0.0000e+00 76/358 [=====>........................] - ETA: 4s - loss: 0.2946 - categorical_accuracy: 0.3684 - binary_accuracy: 0.8702 - accuracy: 0.0000e+00 80/358 [=====>........................] - ETA: 4s - loss: 0.2944 - categorical_accuracy: 0.3688 - binary_accuracy: 0.8699 - accuracy: 0.0000e+00 84/358 [======>.......................] - ETA: 4s - loss: 0.2906 - categorical_accuracy: 0.3750 - binary_accuracy: 0.8711 - accuracy: 0.0000e+00 88/358 [======>.......................] - ETA: 4s - loss: 0.2888 - categorical_accuracy: 0.3750 - binary_accuracy: 0.8720 - accuracy: 0.0000e+00 92/358 [======>.......................] - ETA: 4s - loss: 0.2902 - categorical_accuracy: 0.3777 - binary_accuracy: 0.8716 - accuracy: 0.0000e+00 96/358 [=======>......................] - ETA: 4s - loss: 0.2883 - categorical_accuracy: 0.3724 - binary_accuracy: 0.8722 - accuracy: 0.0000e+00100/358 [=======>......................] - ETA: 4s - loss: 0.2867 - categorical_accuracy: 0.3775 - binary_accuracy: 0.8716 - accuracy: 0.0000e+00104/358 [=======>......................] - ETA: 4s - loss: 0.2865 - categorical_accuracy: 0.3798 - binary_accuracy: 0.8717 - accuracy: 0.0000e+00108/358 [========>.....................] - ETA: 4s - loss: 0.2834 - categorical_accuracy: 0.3727 - binary_accuracy: 0.8720 - accuracy: 0.0000e+00112/358 [========>.....................] - ETA: 3s - loss: 0.2839 - categorical_accuracy: 0.3795 - binary_accuracy: 0.8724 - accuracy: 0.0000e+00116/358 [========>.....................] - ETA: 3s - loss: 0.2820 - categorical_accuracy: 0.3772 - binary_accuracy: 0.8721 - accuracy: 0.0000e+00120/358 [=========>....................] - ETA: 3s - loss: 0.2816 - categorical_accuracy: 0.3812 - binary_accuracy: 0.8719 - accuracy: 0.0000e+00124/358 [=========>....................] - ETA: 3s - loss: 0.2814 - categorical_accuracy: 0.3810 - binary_accuracy: 0.8723 - accuracy: 0.0000e+00128/358 [=========>....................] - ETA: 3s - loss: 0.2812 - categorical_accuracy: 0.3789 - binary_accuracy: 0.8721 - accuracy: 0.0000e+00132/358 [==========>...................] - ETA: 3s - loss: 0.2804 - categorical_accuracy: 0.3845 - binary_accuracy: 0.8725 - accuracy: 0.0000e+00136/358 [==========>...................] - ETA: 3s - loss: 0.2825 - categorical_accuracy: 0.3842 - binary_accuracy: 0.8719 - accuracy: 0.0000e+00140/358 [==========>...................] - ETA: 3s - loss: 0.2857 - categorical_accuracy: 0.3839 - binary_accuracy: 0.8716 - accuracy: 0.0000e+00144/358 [===========>..................] - ETA: 3s - loss: 0.2858 - categorical_accuracy: 0.3854 - binary_accuracy: 0.8721 - accuracy: 0.0000e+00148/358 [===========>..................] - ETA: 3s - loss: 0.2837 - categorical_accuracy: 0.3834 - binary_accuracy: 0.8727 - accuracy: 0.0000e+00152/358 [===========>..................] - ETA: 3s - loss: 0.2837 - categorical_accuracy: 0.3849 - binary_accuracy: 0.8727 - accuracy: 0.0000e+00156/358 [============>.................] - ETA: 3s - loss: 0.2861 - categorical_accuracy: 0.3814 - binary_accuracy: 0.8719 - accuracy: 0.0000e+00160/358 [============>.................] - ETA: 3s - loss: 0.2854 - categorical_accuracy: 0.3859 - binary_accuracy: 0.8725 - accuracy: 0.0000e+00164/358 [============>.................] - ETA: 3s - loss: 0.2841 - categorical_accuracy: 0.3887 - binary_accuracy: 0.8733 - accuracy: 0.0000e+00168/358 [=============>................] - ETA: 3s - loss: 0.2836 - categorical_accuracy: 0.3854 - binary_accuracy: 0.8732 - accuracy: 0.0000e+00172/358 [=============>................] - ETA: 3s - loss: 0.2848 - categorical_accuracy: 0.3837 - binary_accuracy: 0.8733 - accuracy: 0.0000e+00176/358 [=============>................] - ETA: 2s - loss: 0.2830 - categorical_accuracy: 0.3807 - binary_accuracy: 0.8738 - accuracy: 0.0000e+00180/358 [==============>...............] - ETA: 2s - loss: 0.2828 - categorical_accuracy: 0.3750 - binary_accuracy: 0.8731 - accuracy: 0.0000e+00184/358 [==============>...............] - ETA: 2s - loss: 0.2827 - categorical_accuracy: 0.3709 - binary_accuracy: 0.8720 - accuracy: 0.0000e+00188/358 [==============>...............] - ETA: 2s - loss: 0.2813 - categorical_accuracy: 0.3697 - binary_accuracy: 0.8725 - accuracy: 0.0000e+00192/358 [===============>..............] - ETA: 2s - loss: 0.2819 - categorical_accuracy: 0.3724 - binary_accuracy: 0.8731 - accuracy: 0.0000e+00196/358 [===============>..............] - ETA: 2s - loss: 0.2808 - categorical_accuracy: 0.3699 - binary_accuracy: 0.8730 - accuracy: 0.0000e+00200/358 [===============>..............] - ETA: 2s - loss: 0.2811 - categorical_accuracy: 0.3663 - binary_accuracy: 0.8729 - accuracy: 0.0000e+00204/358 [================>.............] - ETA: 2s - loss: 0.2816 - categorical_accuracy: 0.3652 - binary_accuracy: 0.8728 - accuracy: 0.0000e+00208/358 [================>.............] - ETA: 2s - loss: 0.2832 - categorical_accuracy: 0.3678 - binary_accuracy: 0.8727 - accuracy: 0.0000e+00212/358 [================>.............] - ETA: 2s - loss: 0.2822 - categorical_accuracy: 0.3703 - binary_accuracy: 0.8731 - accuracy: 0.0000e+00216/358 [=================>............] - ETA: 2s - loss: 0.2830 - categorical_accuracy: 0.3681 - binary_accuracy: 0.8728 - accuracy: 0.0000e+00220/358 [=================>............] - ETA: 2s - loss: 0.2815 - categorical_accuracy: 0.3670 - binary_accuracy: 0.8730 - accuracy: 0.0000e+00224/358 [=================>............] - ETA: 2s - loss: 0.2801 - categorical_accuracy: 0.3694 - binary_accuracy: 0.8736 - accuracy: 0.0000e+00228/358 [==================>...........] - ETA: 2s - loss: 0.2792 - categorical_accuracy: 0.3728 - binary_accuracy: 0.8741 - accuracy: 0.0000e+00232/358 [==================>...........] - ETA: 2s - loss: 0.2781 - categorical_accuracy: 0.3772 - binary_accuracy: 0.8744 - accuracy: 0.0000e+00236/358 [==================>...........] - ETA: 1s - loss: 0.2782 - categorical_accuracy: 0.3771 - binary_accuracy: 0.8743 - accuracy: 0.0000e+00240/358 [===================>..........] - ETA: 1s - loss: 0.2781 - categorical_accuracy: 0.3781 - binary_accuracy: 0.8743 - accuracy: 0.0000e+00244/358 [===================>..........] - ETA: 1s - loss: 0.2789 - categorical_accuracy: 0.3770 - binary_accuracy: 0.8738 - accuracy: 0.0000e+00248/358 [===================>..........] - ETA: 1s - loss: 0.2798 - categorical_accuracy: 0.3780 - binary_accuracy: 0.8736 - accuracy: 0.0000e+00252/358 [====================>.........] - ETA: 1s - loss: 0.2802 - categorical_accuracy: 0.3790 - binary_accuracy: 0.8736 - accuracy: 0.0000e+00256/358 [====================>.........] - ETA: 1s - loss: 0.2798 - categorical_accuracy: 0.3809 - binary_accuracy: 0.8738 - accuracy: 0.0000e+00260/358 [====================>.........] - ETA: 1s - loss: 0.2811 - categorical_accuracy: 0.3827 - binary_accuracy: 0.8735 - accuracy: 0.0000e+00264/358 [=====================>........] - ETA: 1s - loss: 0.2799 - categorical_accuracy: 0.3845 - binary_accuracy: 0.8738 - accuracy: 0.0000e+00268/358 [=====================>........] - ETA: 1s - loss: 0.2786 - categorical_accuracy: 0.3843 - binary_accuracy: 0.8742 - accuracy: 0.0000e+00272/358 [=====================>........] - ETA: 1s - loss: 0.2787 - categorical_accuracy: 0.3860 - binary_accuracy: 0.8738 - accuracy: 0.0000e+00276/358 [======================>.......] - ETA: 1s - loss: 0.2779 - categorical_accuracy: 0.3868 - binary_accuracy: 0.8738 - accuracy: 0.0000e+00280/358 [======================>.......] - ETA: 1s - loss: 0.2779 - categorical_accuracy: 0.3893 - binary_accuracy: 0.8742 - accuracy: 0.0000e+00284/358 [======================>.......] - ETA: 1s - loss: 0.2797 - categorical_accuracy: 0.3891 - binary_accuracy: 0.8741 - accuracy: 0.0000e+00288/358 [=======================>......] - ETA: 1s - loss: 0.2801 - categorical_accuracy: 0.3898 - binary_accuracy: 0.8741 - accuracy: 0.0000e+00292/358 [=======================>......] - ETA: 1s - loss: 0.2813 - categorical_accuracy: 0.3904 - binary_accuracy: 0.8737 - accuracy: 0.0000e+00296/358 [=======================>......] - ETA: 1s - loss: 0.2809 - categorical_accuracy: 0.3902 - binary_accuracy: 0.8737 - accuracy: 0.0000e+00300/358 [========================>.....] - ETA: 0s - loss: 0.2804 - categorical_accuracy: 0.3883 - binary_accuracy: 0.8735 - accuracy: 0.0000e+00304/358 [========================>.....] - ETA: 0s - loss: 0.2816 - categorical_accuracy: 0.3873 - binary_accuracy: 0.8730 - accuracy: 0.0000e+00308/358 [========================>.....] - ETA: 0s - loss: 0.2825 - categorical_accuracy: 0.3872 - binary_accuracy: 0.8726 - accuracy: 0.0000e+00312/358 [=========================>....] - ETA: 0s - loss: 0.2838 - categorical_accuracy: 0.3870 - binary_accuracy: 0.8724 - accuracy: 0.0000e+00315/358 [=========================>....] - ETA: 0s - loss: 0.2847 - categorical_accuracy: 0.3865 - binary_accuracy: 0.8721 - accuracy: 0.0000e+00319/358 [=========================>....] - ETA: 0s - loss: 0.2843 - categorical_accuracy: 0.3864 - binary_accuracy: 0.8720 - accuracy: 0.0000e+00323/358 [==========================>...] - ETA: 0s - loss: 0.2841 - categorical_accuracy: 0.3870 - binary_accuracy: 0.8719 - accuracy: 0.0000e+00327/358 [==========================>...] - ETA: 0s - loss: 0.2849 - categorical_accuracy: 0.3869 - binary_accuracy: 0.8718 - accuracy: 0.0000e+00331/358 [==========================>...] - ETA: 0s - loss: 0.2852 - categorical_accuracy: 0.3844 - binary_accuracy: 0.8716 - accuracy: 0.0000e+00335/358 [===========================>..] - ETA: 0s - loss: 0.2850 - categorical_accuracy: 0.3858 - binary_accuracy: 0.8718 - accuracy: 0.0000e+00339/358 [===========================>..] - ETA: 0s - loss: 0.2833 - categorical_accuracy: 0.3879 - binary_accuracy: 0.8723 - accuracy: 0.0000e+00343/358 [===========================>..] - ETA: 0s - loss: 0.2835 - categorical_accuracy: 0.3848 - binary_accuracy: 0.8721 - accuracy: 0.0000e+00346/358 [===========================>..] - ETA: 0s - loss: 0.2835 - categorical_accuracy: 0.3837 - binary_accuracy: 0.8719 - accuracy: 0.0000e+00350/358 [============================>.] - ETA: 0s - loss: 0.2843 - categorical_accuracy: 0.3836 - binary_accuracy: 0.8718 - accuracy: 0.0000e+00354/358 [============================>.] - ETA: 0s - loss: 0.2846 - categorical_accuracy: 0.3828 - binary_accuracy: 0.8718 - accuracy: 0.0000e+00358/358 [==============================] - ETA: 0s - loss: 0.2840 - categorical_accuracy: 0.3836 - binary_accuracy: 0.8722 - accuracy: 0.0000e+00358/358 [==============================] - 6s 16ms/step - loss: 0.2840 - categorical_accuracy: 0.3836 - binary_accuracy: 0.8722 - accuracy: 0.0000e+00
test25.csv val_performance = [0.28399213349835845, 0.3836477987421384, 0.8721585070086728, 0.0]
test25.csv val_loss = 0.28399213349835845
test25.csv val_metric = 0.3836477987421384
